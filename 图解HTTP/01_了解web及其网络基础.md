## 1.1 使用 http 协议访问 web
Web 使用一种名为 HTTP（HyperText Transfer Protocol，超文本传输协议 1）的协议作为规范，
完成从客户端到服务器端等一系列运作流程。而协议是指规则的约定.

## 1.2 HTTP 的诞生
3 项 WWW 构建技术，分别是：把 SGML（Standard Generalized Markup Language，标准通用标记语言）
作为页面的文本标记语言的 HTML（HyperText Markup Language，超文本标记语言）；作为文档传递协议的 
HTTP (出现主要是为了解决文本传输的难题)；指定文档所在地址的 URL（Uniform Resource Locator，统一资源定位符）

1990 年 11 月，CERN 成功研发了世界上第一台 Web 服务器和 Web 浏览器。

HTTP 于 1990 年问世。那时的 HTTP 并没有作为正式的标准被建立。现在的 HTTP 其实含有 HTTP1.0 
之前版本的意思，因此被称为HTTP/0.9。

1993 年 1 月，现代浏览器的祖先 NCSA（National Center for Supercomputer Applications，
美国国家超级计算机应用中心）研发的 Mosaic 问世了。同年秋天，Mosaic 的 Windows 版和 Macintosh 版面世。
使用 CGI 技术的 NCSA Web 服务器、NCSA HTTPd 1.0 也差不多是在这个时期出现的。

1994 年 的 12 月，网景通信公司发布了 Netscape Navigator 1.0，1995年微软公司发布 
Internet Explorer 1.0 和 2.0。

紧随其后的是现在已然成为 Web 服务器标准之一的 Apache，当时它以 Apache 0.2 的姿态出现在世人眼前。
而 HTML 也发布了 2.0 版本。

HTTP 正式作为标准被公布是在 1996 年的 5 月，版本被命名为HTTP/1.0，并记载于 RFC1945。
虽说是初期标准，但该协议标准至今仍被广泛使用在服务器端。

1997 年 1 月公布的 HTTP/1.1 是目前主流的 HTTP 协议版本。当初的标准是 RFC2068，
之后发布的修订版 RFC2616 就是当前的最新版本。

2000 年前后，这场浏览器战争随着网景通信公司的衰落而暂告一段落。但就在 2004 年，Mozilla 基金会发布了
Firefox 浏览器，

## 1.3 TCP/IP
通常使用的网络（包括互联网）是在 TCP/IP 协议族的基础上运作的。而 HTTP 属于它内部的一个子集。

TCP/IP 协议族里重要的一点就是分层。TCP/IP 协议族按层次分别分为以下 4 层：应用层、传输层、网络层和数据链路层。

1. 应用层
TCP/IP 协议族内预存了各类通用的应用服务。比如，FTP（FileTransfer Protocol，文件传输协议）
和 DNS（Domain Name System，域名系统）服务就是其中两类。HTTP 协议也处于该层。

2. 传输层
传输层对上层应用层，提供处于网络连接中的两台计算机之间的数据传输。

在传输层有两个性质不同的协议：TCP（Transmission Control Protocol，传输控制协议）
和 UDP（User Data Protocol，用户数据报协议）。

3. 网络层
网络层用来处理在网络上流动的数据包。数据包是网络传输的最小数据单位。该层规定了通过怎样的路径（所谓的传输路线）
到达对方计算机，并把数据包传送给对方。 IP 协议在此

4. 数据链路层
用来处理连接网络的硬件部分。包括控制操作系统、硬件的设备驱动、NIC（Network Interface Card，网络适配器，即网卡），
及光纤等物理可见部分（还包括连接器等一切传输媒介）。硬件上的范畴均在链路层的作用范围之内。

发送端在层与层之间传输数据时，每经过一层时必定会被打上一个该层所属的首部信息。反之，接收端在层与层传输数据时，
每经过一层时会把对应的首部消去。这种把数据信息包装起来的做法称为封装（encapsulate）。

## 1.4 与 HTTP 关系密切的协议 : IP、TCP 和 DNS

- IP
“IP”其实是一种协议的名称。

IP 协议的作用是把各种数据包传送给对方。而要保证确实传送到对方那里，则需要满足各类条件。其中两个重要的条件是 IP 地址
和 MAC 地址（Media Access Control Address）。

IP 地址指明了节点被分配到的地址，MAC 地址是指网卡所属的固定地址。IP 地址可以和 MAC 地址进行配对。IP 地址可变换，但 MAC
地址基本上不会更改。

使用 ARP 协议凭借 MAC 地址进行通信, IP 间的通信依赖 MAC 地址。在进行中转时，会利用下一站中转设备的 MAC地址来搜索下一个中转目标。
这时，会采用 ARP 协议（Address Resolution Protocol）。ARP 是一种用以解析地址的协议，根据通信方的 IP 地址就可以反查出对应的
MAC 地址。

- TCP
TCP 协议为了更容易传送大数据才把数据分割，而且 TCP 协议能够确认数据最终是否送达到对方。

TCP 协议采用了三次握手(three-way handshaking）策略。在传输结束后, TCP 会确认是否成功送达.

握手过程中使用了 TCP 的标志（flag） —— SYN（synchronize） 和 ACK（acknowledgement）。

发送端首先发送一个带 SYN 标志的数据包给对方。接收端收到后，回传一个带有 SYN/ACK 标志的数据包以示传达确认信息。
最后，发送端再回传一个带 ACK 标志的数据包，代表“握手”结束

若在握手过程中某个阶段莫名中断，TCP 协议会再次以相同的顺序发送相同的数据包。

- DNS
负责域名解析的 DNS 服务, 它提供域名到 IP 地址之间的解析服务。

DNS 协议提供通过域名查找 IP 地址，或逆向从 IP 地址反查域名的服务。

## 1.5 URI 和 URL
- URI 统一资源标识符, 用字符串标识某一互联网资源，
- URL 统一资源定位符, 表示资源的地点（互联网上所处的位置）。

可见 URL 是 URI 的子集。

### 绝对 URI 格式
- 协议方案名 http
- 登陆信息 (可选项)
- 服务器地址 
    - hackr.jp 这种 DNS 可解析的名称
    - 192.168.1.1 这类 IPv4 地址
    - [0:0:0:0:0:0:0:1] 这样用方括号括起来的 IPv6 地址名
- 端口号 (可选项, 不填使用默认端口)
- 带层次的文件路径
- 查询字符串 (可选项)
- 片段标识符 (RFC 并没有规定具体使用方法, 可选项)

## 2.1 简单的 HTTP 协议 (主要以 HTTP/1.1)
> 作用是用于客户端与服务器通信

### 请求报文
请求报文是由请求方法、请求 URI、协议版本、可选的请求首部字段和内容实体构成的

### 响应报文
响应报文基本上由协议版本、状态码（表示请求成功或失败的数字代码）、用以解释状态码的原因短语、
可选的响应首部字段以及实体主体构成。

HTTP 是无状态协议, 协议自身不具备保存之前发送过的请求或响应的功能

### 方法 method
- GET 请求资源

- POST 传输实体主体

- PUT 传输文件, 由于 PUT 本身不带验证机制, 一般的 web 网站不使用该方法. 当配合 Web 应用程序的验证机制，
或遵守 REST 标准时还是有可能会开放使用

- HEAD 获取报文首部, HEAD 方法和 GET 方法一样，只是不返回报文主体部分。用于确认URI 的有效性及资源更新的日期时间等。

- DELETE 删除文件, 与 PUT 一样本事不带验证机制, 一般的 web 网站不使用该方法. 当配合 Web 应用程序的验证机制，
或遵守 REST 标准时还是有可能会开放使用

- OPTIONS 询问支持的方法, OPTIONS 方法用来查询针对请求 URI 指定的资源支持的方法. 如服务器支持 GET || POST

- TRACE 追踪路径. 客户端通过 TRACE 方法可以查询发送出去的请求是怎样被加工修改/ 篡改的。这是因为，
请求想要连接到源目标服务器可能会通过代理中转，TRACE 方法就是用来确认连接过程中发生的一系列操作。
但是，TRACE 方法本来就不怎么常用，再加上它容易引发XST（Cross-Site Tracing，跨站追踪）攻击，通常就更不会用到了。


- CONNECT 要求用隧道协议连接代理. CONNECT 方法要求在与代理服务器通信时建立隧道，实现用隧道协
议进行 TCP 通信。主要使用 SSL（Secure Sockets Layer，安全套接层）和 TLS（Transport Layer Security，传输层安全）
协议把通信内容加密后经网络隧道传输。

### 瓶颈问题
> 现阶段每进行一次 http 通行就要断开一次 TCP 连接. 请求内容过多时, 频繁的断开链接 TCP, 增加通信量的开销.

## 2.2 持久链接
> 为解决上述 TCP 连接的问题，HTTP/1.1 和一部分的 HTTP/1.0 想出了持久连接（HTTP Persistent Connections，
也称为 HTTP keep-alive 或 sHTTP connection reuse）的方法

持久性链接就是在进行一次 TCP 链接之后, 能够执行多次请求响应的交互

在 HTTP/1.1 中，所有的连接默认都是持久连接，但在 HTTP/1.0 内并未标准化。

用持久连接可以让请求更快结束。而管线化技术则比持久连接还要快。请求数越多，时间差就越明显。

## 2.3 使用 cookie 的状态管理
> Cookie 技术通过在请求和响应报文中写入 Cookie 信息来控制客户端的状态。

Cookie 会根据从服务器端发送的响应报文内的一个叫做 Set-Cookie 的首部字段信息，通知客户端保存 Cookie。
当下次客户端再往该服务器发送请求时，客户端会自动在请求报文中加入 Cookie 值后发送出去。

## 3.0 HTTP 报文内的 HTTP信息