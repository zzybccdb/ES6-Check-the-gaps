# 字符串
1. 字符&编码 
    - 1.1 unicode 
    - 1.2 uft-32
    - 1.3 utf-16


## 1. 字符&编码
<br/>

### 1.1 unicode 是什么
unicode 的目标是希望将所有的字符包含在一个集合里, 这样就不会出现乱码的问题.
它是一个字符集. utf-8, utf-16, utf-32指的是编码方式, 即一个字符采用多少字节标示. **JS采用 unicode 字符集, 但是用的是 UCS-2编码.**

**所以需要明确 unicode 是字符集, utf-8, utf-16, utf-32, UCS-2 是编码方式**

unicode 不是一次性定义完所有字符, 是分区定义.
每个区可以存放65536个（2^16）字符，称为一个平面（plane）。
目前，一共有17(2^5)个平面，也就是说，整个Unicode字符集的大小现在是2^21
最前面的65536个字符位，称为基本平面（缩写BMP）.

它的码点范围是从0一直到2^16-1，写成16进制就是从U+0000到U+FFFF。所有最常见的字符都放在这个平面，这是Unicode最先定义和公布的一个平面。

剩下的字符都放在辅助平面（缩写SMP），码点范围从U+010000一直到U+10FFFF。

<br/>

### 1.2 utf-32

使用与 unicode 相同数量的码点, 4个字节表示一个字符

- pro: 查找效率高, 时间复杂度 O(1)
- con: 占用空间大, 比相同 ASCII 编码文件大4倍

HTML5 标准明确规定不适用 uft-32 编码

<br/>

### 1.3 utf-16
UTF-16编码介于UTF-32与UTF-8之间，同时结合了定长和变长两种编码方法的特点。

它的编码规则很简单：基本平面的字符占用2个字节，辅助平面的字符占用4个字节。也就是说，UTF-16的编码长度要么是2个字节（U+0000到U+FFFF），要么是4个字节（U+010000到U+10FFFF）。

<br/>

### 1.4 utf-8
utf-8 是一种可变长度的编码方式, 越常用的字符编码越短, 最前面的128个字符，只使用1个字节表示，与ASCII码完全相同。是互联网网页中常见的编码方式

<br/>

### 1.5 UCS-2
基于历史原因, UCS-2 编码在基本面(BPM) 的结果与 utf-16 一致, 都是以两个字节表示, 所以 utf-16 本质是 UCS-2 的超集.

目前 JS 已经加强了对 4 字节编码的支持.

\uxxxx 形式表示一个字符 xxxx 表示 2 字节的码点
```
'\u0061'
// 'a'
```
辅助平面内的码点需要使用两个双字节的形式表示, \u后面跟上超过0xFFFF的数值（比如\u20BB7），JavaScript 会理解成\u20BB+7。由于\u20BB是一个不可打印字符，所以只会显示一个空格，后面跟着一个7
```
"\uD842\uDFB7"
// "𠮷"

"\u20BB7"
// " 7"
```

为了支持 utf-16 的 4 字节编码, ES6 对这一点做出了改进，只要将码点放入大括号，就能正确解读该字符。大括号表示法与四字节的 UTF-16 编码是等价的。有了这种表示法之后，JavaScript 共有 6 种方法可以表示一个字符
```
'\u{20BB7}'
// '𠮷'

'\u{1F680}' === '\uD83D\uDE80'
// true

'\z' === 'z'  // true
'\172' === 'z' // true
'\x7A' === 'z' // true
'\u007A' === 'z' // true
'\u{7A}' === 'z' // true
```

<br/>

## 2. for...of 循环 字符串接口遍历

<br/>

### 2.1 字符串的遍历器接口
ES6 为字符串添加了遍历器接口（详见《Iterator》一章），使得字符串可以被for...of循环遍历。同时可以识别大于0xFFFF的码点，传统的for循环无法识别这样的码点。

```
for (let codePoint of 'foo') {
  console.log(codePoint)
}
// "f"
// "o"
// "o"

let text = String.fromCodePoint(0x20BB7);

for (let i = 0; i < text.length; i++) {
  console.log(text[i]);
}
// " "
// " "

for (let i of text) {
  console.log(i);
}
// "𠮷"

```


JavaScript 字符串允许直接输入字符，以及输入字符的转义形式。但是，JavaScript 规定有5个字符，不能在字符串里面直接使用，只能使用转义形式。

```
U+005C：反斜杠（reverse solidus)
U+000D：回车（carriage return）
U+2028：行分隔符（line separator）
U+2029：段分隔符（paragraph separator）
U+000A：换行符（line feed）
```
**需注意**
>  JSON 格式允许字符串里面直接使用 U+2028（行分隔符）和 U+2029（段分隔符）。这样一来，服务器输出的 JSON 被JSON.parse解析，就有可能直接报错。
```
const json = '"\u2028"';
JSON.parse(json); // 可能报错
```

>ES2019 允许 JavaScript 字符串直接输入 U+2028（行分隔符）和 U+2029（段分隔符）。

## 3. 标签模版

紧跟在一个函数名后面，该函数将被调用来处理这个模板字符串。这被称为“标签模板”功能（tagged template）

```
alert`hello`
// 等同于
alert(['hello'])
```

如果模板字符里面有变量，就不是简单的调用了，而是会将模板字符串先处理成多个参数，再调用函数。

```
let a = 5;
let b = 10;

tag`Hello ${ a + b } world ${ a * b }`;

// 等同于
tag(['Hello ', ' world ', ''], 15, 50);

function tag() {
    console.log(...arguments)
}
```

## 4. 新增方法